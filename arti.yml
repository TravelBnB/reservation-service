config:
  target: 'http://localhost:3003'
  phases:
    - duration: 60
      arrivalRate: 10
  payload:
    - path: "./test.csv"
      fields:
        - "listingid"
        - "guestid"
      order: "sequence"
    - path: "./post.csv"
      fields:
        - "postlistingid"
        - "postguestid"
        - "postcheckin"
        - "postcheckout"
        - "postcharge"
        - "postdog"
        - "postadult"
        - "postcreateat"
      order: "sequence"
  variables:
    listings:
      - [9999955, 9999981, 9999920, 9999725, 9999719, 9999889, 9999894]
  #   guestid:
  #     - [1, 2, 3, 4, 5]
scenarios:
  - flow:
      # - loop:
      #     - get:
      #         url: "/listings/{{ $loopElement }}/reservations"
      #   over: listings
      - loop:
          - get: 
              url: "/listings/{{ listingid }}/guests/{{ guestid }}/reservations"
        count: 100
      - loop:
          - post:
              url: "/reservations"
              json:
                listing_id: "{{ postlistingid }}"
                guest_id: "{{ postguestid }}"
                check_in: "{{ postcheckin }}"
                check_out: "{{ postcheckout }}"
                total_charge: "{{ postcharge }}"
                total_pup: "{{ postdog }}"
                total_adult: "{{ postadult }}"
                create_at: "{{ postcreateat }}"
        count: 1
      # - get:
      #     url: "/listings/{{ listingid }}/guests/{{ guestid }}/reservations"
      # - get:
      #     url: "/listings/4020/reservations"
    # - loop:
    #   - get:
    #     url: "/listings/{{ $loopElement }}"
    #   over: listing_id
